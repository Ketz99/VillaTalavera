<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administración - Villa Talavera</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;600&family=Roboto:wght@400&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="css/admin.css">
    <link rel="shortcut icon" href="img/logo-corto.png" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabaseClient.js"></script>
 </head>

<body>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">


    <header class="site-header">

        <div class="top-bar">
            <div class="social-icons">
                <a href="#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
                <a href="#" aria-label="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
                <a href="#" aria-label="YouTube"><i class="fa-brands fa-youtube"></i></a>
            </div>
        </div>

        <div class="main-header-container">
            <div class="header-icon-left">
                <a href="#" aria-label="Buscar"><i class="fa-solid fa-magnifying-glass"></i></a>
            </div>

            <div class="logo-container">
                <a href="index.html">
                    <img src="img/logo-largo.jpg" alt="Logo de Villa Talavera" class="logo-image">
                </a>
            </div>

            <div class="header-icon-right">
                <a href="#" aria-label="Mi Cuenta"><i class="fa-regular fa-user"></i></a>
                <button id="logout-button" title="Cerrar Sesión" class="logout-btn"><i class="fa-solid fa-right-from-bracket"></i></button>
            </div>

            <!-- Botón hamburguesa -->
            <button class="hamburger-btn" aria-label="Abrir menú">
                <i class="fa-solid fa-bars"></i>
            </button>
        </div>

        <nav class="main-nav">
            <ul>
                <li><a href="#!" data-target="products-section">PRODUCTOS</a></li>
                <li><a href="#!" data-target="categories-section">CATEGORÍAS</a></li>
                <li><a href="#!" data-target="blog-section">BLOG</a></li>
                <li><a href="#!" data-target="banners-section">BANNERS</a></li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <div id="admin-menu" class="menu-grid">
            <div class="menu-card" data-target="products-section">
                <i class="fa-solid fa-cube menu-card-icon"></i>
                <h3>Productos</h3>
                <p>Añadir, editar y gestionar tu inventario de artesanías.</p>
            </div>
            <div class="menu-card" data-target="categories-section">
                <i class="fa-solid fa-layer-group menu-card-icon"></i>
                <h3>Categorías</h3>
                <p>Organizar tus productos en diferentes categorías.</p>
            </div>
            <div class="menu-card" data-target="blog-section">
                <i class="fa-solid fa-pen-nib menu-card-icon"></i>
                <h3>Blog</h3>
                <p>Crear y administrar las publicaciones de tu blog.</p>
            </div>
            <div class="menu-card" data-target="banners-section">
                <i class="fa-solid fa-image menu-card-icon"></i>
                <h3>Banners</h3>
                <p>Gestionar los banners promocionales de la página de inicio.</p>
            </div>
        </div>

        <section id="products-section" class="admin-section hidden">
            <button class="back-to-menu-btn">&larr; Volver al Menú</button>

            <h2>Inventario Actual</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Precio</th>
                            <th>Stock</th>
                            <th>Destacado</th> <!-- NUEVA COLUMNA -->
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="inventory-table-body"></tbody>
                </table>
            </div>

            <div class="form-container">
                <h2 id="form-title">Agregar/Editar Producto</h2>
                <form id="product-form">
                    <input type="hidden" id="product-id">
                    <input type="text" id="nombre" placeholder="Nombre del producto" required>
                    <select id="product-category" required>
                        <option value="">Cargando categorías...</option>
                    </select>
                    <textarea id="descripcion" placeholder="Descripción"></textarea>
                    <input type="number" id="precio" placeholder="Precio" step="0.01" required>
                    <input type="number" id="stock" placeholder="Stock" required>
                    
                    <!-- NUEVO CAMPO PARA DESTACADO -->
                    <select id="destacado" required>
                        <option value="false">No destacado</option>
                        <option value="true">Sí, destacar producto</option>
                    </select>

                    <label for="product-image">Añadir nueva imagen:</label>
                    <input type="file" id="product-image" accept="image/png, image/jpeg">
                    <div class="form-buttons">
                        <button type="submit" id="save-button">Guardar</button>
                        <button type="button" id="cancel-button" class="hidden">Cancelar Edición</button>
                    </div>
                </form>
                <div id="image-management-section" class="hidden">
                    <h3>Imágenes Actuales</h3>
                    <div id="current-images-container" class="image-gallery"></div>
                </div>
            </div>
        </section>

        <section id="categories-section" class="admin-section hidden">
            <button class="back-to-menu-btn">&larr; Volver al Menú</button>
            <h2>Categorías Actuales</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="category-table-body"></tbody>
                </table>
            </div>
            <div class="form-container">
                <h2 id="category-form-title">Agregar/Editar Categoría</h2>
                <form id="category-form">
                    <input type="hidden" id="category-id">
                    <input type="text" id="category-name" placeholder="Nombre de la categoría" required>
                    <textarea id="category-description" placeholder="Descripción de la categoría"></textarea>
                    <div id="category-image-preview-container" class="hidden">
                        <p>Imagen actual:</p>
                        <div class="image-thumbnail">
                            <img id="current-category-image" src="" alt="Imagen actual de la categoría">
                            <button type="button" id="delete-category-image-btn" class="delete-btn">X</button>
                        </div>
                    </div>
                    <label for="category-image">Imagen de la categoría:</label>
                    <input type="file" id="category-image" accept="image/png, image/jpeg">
                    <div class="form-buttons">
                        <button type="submit" id="save-category-button">Guardar Categoría</button>
                        <button type="button" id="cancel-category-button" class="hidden">Cancelar Edición</button>
                    </div>
                </form>
            </div>
        </section>

        <section id="blog-section" class="admin-section hidden">
            <button class="back-to-menu-btn">&larr; Volver al Menú</button>
            <h2>Publicaciones del Blog</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Título</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="blog-table-body"></tbody>
                </table>
            </div>
            <div class="form-container">
                <h2 id="blog-form-title">Agregar/Editar Publicación</h2>
                <form id="blog-form">
                    <input type="hidden" id="post-id">
                    <input type="text" id="post-title" placeholder="Título de la Publicación" required>
                    <textarea id="post-summary" placeholder="Resumen corto (para la vista previa)" rows="3"></textarea>
                    <textarea id="post-content" placeholder="Contenido completo de la publicación..."
                        rows="10"></textarea>
                    <select id="post-status" required>
                        <option value="borrador">Borrador</option>
                        <option value="publicado">Publicado</option>
                    </select>
                    <div id="post-image-preview-container" class="hidden">
                        <p>Imagen destacada actual:</p>
                        <div class="image-thumbnail">
                            <img id="current-post-image" src="" alt="Imagen destacada actual">
                            <button type="button" id="delete-post-image-btn" class="delete-btn">X</button>
                        </div>
                    </div>
                    <label for="post-image">Imagen destacada:</label>
                    <input type="file" id="post-image" accept="image/png, image/jpeg">
                    <div class="form-buttons">
                        <button type="submit" id="save-post-button">Guardar Publicación</button>
                        <button type="button" id="cancel-post-button" class="hidden">Cancelar Edición</button>
                    </div>
                </form>
            </div>
        </section>

        <section id="banners-section" class="admin-section hidden">
            <button class="back-to-menu-btn">&larr; Volver al Menú</button>
            <h2>Banners Actuales</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Imagen</th>
                            <th>Título</th>
                            <th>Enlace</th>
                            <th>Activo</th>
                            <th>Orden</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="banner-table-body"></tbody>
                </table>
            </div>
            <div class="form-container">
                <h2 id="banner-form-title">Agregar/Editar Banner</h2>
                <form id="banner-form">
                    <input type="hidden" id="banner-id">
                    <input type="text" id="banner-title" placeholder="Título del Banner (ej. 'Nuevos Colibríes')">
                    <textarea id="banner-subtitle" placeholder="Subtítulo (ej. 'Hechos a mano en Tonalá')"
                        rows="2"></textarea>
                    <input type="url" id="banner-link" placeholder="Enlace de destino (ej. /productos/talavera)">
                    <input type="number" id="banner-order" placeholder="Orden de aparición (ej. 1, 2, 3...)">
                    <div class="checkbox-container">
                        <input type="checkbox" id="banner-active" checked>
                        <label for="banner-active">Mostrar este banner en la página de inicio</label>
                    </div>
                    <div id="banner-image-preview-container" class="hidden">
                        <p>Imagen actual del banner:</p>
                        <div class="image-thumbnail">
                            <img id="current-banner-image" src="" alt="Imagen actual del banner">
                        </div>
                    </div>
                    <label for="banner-image">Imagen del banner (obligatoria):</label>
                    <input type="file" id="banner-image" accept="image/png, image/jpeg">
                    <div class="form-buttons">
                        <button type="submit" id="save-banner-button">Guardar Banner</button>
                        <button type="button" id="cancel-banner-button" class="hidden">Cancelar Edición</button>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <footer class="site-footer">
        <div class="footer-container">

            <div class="footer-column footer-links">
                <h4>Información</h4>
                <ul>
                    <li><a href="/busqueda">Búsqueda</a></li>
                    <li><a href="/terminos">Términos y Condiciones</a></li>
                    <li><a href="/contacto">Contacto</a></li>
                </ul>
            </div>

            <div class="footer-column footer-subscribe">
                <h4>SUSCRÍBETE</h4>
                <p>Suscríbete e infórmate de nuestras ofertas y novedades.</p>

                <form class="subscribe-form">
                    <input type="email" placeholder="Suscríbete a nuestra lista de correo">
                    <button type="submit" aria-label="Suscribirse">
                        <i class="fa-regular fa-envelope"></i>
                    </button>
                </form>

                <div class="footer-social">
                    <a href="#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
                    <a href="#" aria-label="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
                    <a href="#" aria-label="YouTube"><i class="fa-brands fa-youtube"></i></a>
                </div>
            </div>

            <div class="footer-column footer-logo">
                <div class="logo-circle">
                    <img src="img/icono.png" alt="Logo de Villa Talavera">
                </div>
            </div>

        </div>
    </footer>

    
    <script src="js/admin.js"></script>
</body>

</html>
